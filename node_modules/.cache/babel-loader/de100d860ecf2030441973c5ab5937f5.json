{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Pega carona 01/Documents/PegaCarona.Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/Pega carona 01/Documents/PegaCarona.Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/Pega carona 01/Documents/PegaCarona.Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{Link}from'react-router-dom';import Button from'./Button';import Input from'./Input';import useForm from'./useForm';import{TOKEN_POST,USER_GET}from'./api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=function LoginForm(){var username=useForm();var password=useForm();React.useEffect(function(){var token=window.localStorage.getItem('token');if(token){getUser(token);}},[]);function getUser(_x){return _getUser.apply(this,arguments);}function _getUser(){_getUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token){var _USER_GET,url,options,response,json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_USER_GET=USER_GET(token),url=_USER_GET.url,options=_USER_GET.options;_context.next=3;return fetch(url,options);case 3:response=_context.sent;_context.next=6;return response.json();case 6:json=_context.sent;console.log(json);case 8:case\"end\":return _context.stop();}}},_callee);}));return _getUser.apply(this,arguments);}function handleSubmit(_x2){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var _TOKEN_POST,url,options,response,json;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();if(!(username.validate()&&password.validate())){_context2.next=11;break;}_TOKEN_POST=TOKEN_POST({username:username.value,password:password.value}),url=_TOKEN_POST.url,options=_TOKEN_POST.options;_context2.next=5;return fetch(url,options);case 5:response=_context2.sent;_context2.next=8;return response.json();case 8:json=_context2.sent;window.localStorage.setItem('token',json.token);getUser(json.token);case 11:case\"end\":return _context2.stop();}}},_callee2);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Input,_objectSpread({label:\"Usu\\xE1rio\",type:\"text\",name:\"username\"},username)),/*#__PURE__*/_jsx(Input,_objectSpread({label:\"Senha\",type:\"password\",name:\"password\"},password)),/*#__PURE__*/_jsx(Button,{children:\"Entrar\"})]}),/*#__PURE__*/_jsx(Link,{to:\"/login/criar\",children:\"Cadastro\"})]});};export default LoginForm;","map":{"version":3,"sources":["C:/Users/Pega carona 01/Documents/PegaCarona.Dev/src/components/pages/login/LoginForm.js"],"names":["React","Link","Button","Input","useForm","TOKEN_POST","USER_GET","LoginForm","username","password","useEffect","token","window","localStorage","getItem","getUser","url","options","fetch","response","json","console","log","handleSubmit","event","preventDefault","validate","value","setItem"],"mappings":"ifAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,OAArC,C,wFAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtB,GAAMC,CAAAA,QAAQ,CAAGJ,OAAO,EAAxB,CACA,GAAMK,CAAAA,QAAQ,CAAGL,OAAO,EAAxB,CAEAJ,KAAK,CAACU,SAAN,CAAgB,UAAM,CACpB,GAAMC,CAAAA,KAAK,CAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAd,CACA,GAAIH,KAAJ,CAAW,CACTI,OAAO,CAACJ,KAAD,CAAP,CACD,CACF,CALD,CAKG,EALH,EAJsB,QAWPI,CAAAA,OAXO,iIAWtB,iBAAuBJ,KAAvB,oKAC2BL,QAAQ,CAACK,KAAD,CADnC,CACUK,GADV,WACUA,GADV,CACeC,OADf,WACeA,OADf,uBAEyBC,CAAAA,KAAK,CAACF,GAAD,CAAMC,OAAN,CAF9B,QAEQE,QAFR,qCAGqBA,CAAAA,QAAQ,CAACC,IAAT,EAHrB,QAGQA,IAHR,eAIEC,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAJF,sDAXsB,kDAkBPG,CAAAA,YAlBO,iJAkBtB,kBAA4BC,KAA5B,gKACEA,KAAK,CAACC,cAAN,GADF,KAGMjB,QAAQ,CAACkB,QAAT,IAAuBjB,QAAQ,CAACiB,QAAT,EAH7B,wCAI6BrB,UAAU,CAAC,CAClCG,QAAQ,CAAEA,QAAQ,CAACmB,KADe,CAElClB,QAAQ,CAAEA,QAAQ,CAACkB,KAFe,CAAD,CAJvC,CAIYX,GAJZ,aAIYA,GAJZ,CAIiBC,OAJjB,aAIiBA,OAJjB,wBAS2BC,CAAAA,KAAK,CAACF,GAAD,CAAMC,OAAN,CAThC,QASUE,QATV,uCAUuBA,CAAAA,QAAQ,CAACC,IAAT,EAVvB,QAUUA,IAVV,gBAWIR,MAAM,CAACC,YAAP,CAAoBe,OAApB,CAA4B,OAA5B,CAAqCR,IAAI,CAACT,KAA1C,EACAI,OAAO,CAACK,IAAI,CAACT,KAAN,CAAP,CAZJ,yDAlBsB,+CAkCtB,mBACE,wCACE,6BADF,cAEE,cAAM,MAAM,CAAC,EAAb,CAAgB,QAAQ,CAAEY,YAA1B,wBACE,KAAC,KAAD,gBAAO,KAAK,CAAC,YAAb,CAAuB,IAAI,CAAC,MAA5B,CAAmC,IAAI,CAAC,UAAxC,EAAuDf,QAAvD,EADF,cAEE,KAAC,KAAD,gBAAO,KAAK,CAAC,OAAb,CAAqB,IAAI,CAAC,UAA1B,CAAqC,IAAI,CAAC,UAA1C,EAAyDC,QAAzD,EAFF,cAGE,KAAC,MAAD,qBAHF,GAFF,cAOE,KAAC,IAAD,EAAM,EAAE,CAAC,cAAT,sBAPF,GADF,CAWD,CA7CD,CA+CA,cAAeF,CAAAA,SAAf","sourcesContent":["import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Button from './Button';\r\nimport Input from './Input';\r\nimport useForm from './useForm';\r\nimport { TOKEN_POST, USER_GET } from './api';\r\n\r\nconst LoginForm = () => {\r\n  const username = useForm();\r\n  const password = useForm();\r\n\r\n  React.useEffect(() => {\r\n    const token = window.localStorage.getItem('token');\r\n    if (token) {\r\n      getUser(token);\r\n    }\r\n  }, []);\r\n\r\n  async function getUser(token) {\r\n    const { url, options } = USER_GET(token);\r\n    const response = await fetch(url, options);\r\n    const json = await response.json();\r\n    console.log(json);\r\n  }\r\n\r\n  async function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    if (username.validate() && password.validate()) {\r\n      const { url, options } = TOKEN_POST({\r\n        username: username.value,\r\n        password: password.value,\r\n      });\r\n\r\n      const response = await fetch(url, options);\r\n      const json = await response.json();\r\n      window.localStorage.setItem('token', json.token);\r\n      getUser(json.token);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <section>\r\n      <h1>Login</h1>\r\n      <form action=\"\" onSubmit={handleSubmit}>\r\n        <Input label=\"UsuÃ¡rio\" type=\"text\" name=\"username\" {...username} />\r\n        <Input label=\"Senha\" type=\"password\" name=\"password\" {...password} />\r\n        <Button>Entrar</Button>\r\n      </form>\r\n      <Link to=\"/login/criar\">Cadastro</Link>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n"]},"metadata":{},"sourceType":"module"}